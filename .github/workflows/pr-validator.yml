name: PR Validator

on:
  pull_request:
    types: [opened, synchronize, reopened, ready_for_review]
  pull_request_review:
    types: [submitted, edited]

jobs:
  validate-pr:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: read
      issues: read
      contents: read

    steps:
      - name: Debug
        id: debug
        run: |
            echo "Debugging PR Validator Workflow"    

      - name: Check if PR is linked to an issue
        id: check-linked-issue
        run: |
          PR_NUMBER=${{ github.event.pull_request.number }}
          PR_issue_url="${{ github.event.pull_request.issue_url }}"
          if [ -n "$PR_issue_url" ]; then
            echo "::notice title=Linked Issue::[Linked Issue]($PR_issue_url)"
          else
            echo "::error title=Missing Linked Issue::This PR is not linked to any issue. Please link an issue to this PR before merging."
            exit 1
          fi

      - name: All checks passed
        run: |
          echo ""
          echo "================================"
          echo "âœ… PR VALIDATION SUCCESS"
          echo "================================"
          echo ""
          echo "This PR is ready for merge!"
          echo ""
